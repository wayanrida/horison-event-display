<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Event Hari Ini - Horison Lampung</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #000;
      color: white;
      overflow: hidden;
    }
    .stage {
      position: relative;
      width: 100%;
      height: 100vh;
      background: url('background-1920x1080.png') no-repeat center center;
      background-size: cover;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .header-date {
      margin-top: 30px;
      padding: 10px 40px;
      background: #333;
      border-radius: 40px;
      font-size: 28px;
      font-weight: bold;
    }
    .clock {
      position: absolute;
      top: 20px;
      right: 30px;
      font-size: 22px;
    }
    .table-wrap {
      margin-top: 80px;
      background: rgba(0, 0, 0, 0.7);
      padding: 20px;
      border-radius: 12px;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      font-size: 24px;
      text-align: center;
    }
    th, td {
      padding: 15px 20px;
      border: none;
      background: #111;
      border-radius: 10px;
    }
    th {
      background: transparent;
      font-size: 26px;
    }
    td {
      background: #222;
      color: #fff;
      font-weight: bold;
    }
    /* Animasi marquee */
    .marquee {
      display: inline-block;
      white-space: nowrap;
      animation: scroll-text 10s linear infinite;
    }
    @keyframes scroll-text {
      0% { transform: translateX(100%); }
      100% { transform: translateX(-100%); }
    }
    .scroll-container {
      overflow: hidden;
      width: 100%;
    }
  </style>
</head>
<body>
  <div class="stage">
    <div class="clock" id="clock">00:00:00</div>
    <div class="header-date" id="headerDate">EVENT HARI INI</div>
    <div class="table-wrap">
      <table id="eventTable">
        <thead>
          <tr>
            <th>TIME</th>
            <th>EVENT</th>
            <th>ROOM</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <script>
    // Link CSV Google Sheets
    const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vT7JWjVeETxcC1epq9wg5oLA8C-BT7iNTCW6mAHfKjMNWe0LI_Ns2srMwOFsdBQE_bIYwKqq7xVoMLU/pub?gid=974824918&single=true&output=csv";
    const REFRESH_MS = 30000; // refresh tiap 30 detik

    // Jam realtime
    function updateClock() {
      const now = new Date();
      const h = String(now.getHours()).padStart(2, '0');
      const m = String(now.getMinutes()).padStart(2, '0');
      const s = String(now.getSeconds()).padStart(2, '0');
      document.getElementById("clock").textContent = `${h}.${m}.${s}`;
    }
    setInterval(updateClock, 1000);
    updateClock();

    // Tanggal header
    function updateDateHeader() {
      const now = new Date();
      const options = { day: 'numeric', month: 'long', year: 'numeric' };
      const tanggal = now.toLocaleDateString('id-ID', options).toUpperCase();
      document.getElementById("headerDate").textContent = `EVENT ${tanggal}`;
    }
    updateDateHeader();

    // Ambil CSV dari Google Sheets
    async function loadCSV() {
      try {
        const response = await fetch(CSV_URL);
        const data = await response.text();
        renderTable(data);
      } catch (error) {
        console.error("Gagal ambil data CSV:", error);
      }
    }

    // Render isi tabel
    function renderTable(csv) {
      const rows = csv.trim().split("\n").map(r => r.split(","));
      const tbody = document.querySelector("#eventTable tbody");
      tbody.innerHTML = "";

      rows.slice(1).forEach(row => {
        const [time, event, room, date] = row;

        // filter hanya untuk hari ini
        const today = new Date().toLocaleDateString('id-ID');
        if (date && date !== today) return;

        const tr = document.createElement("tr");

        const tdTime = document.createElement("td");
        tdTime.textContent = time;

        const tdEvent = document.createElement("td");
        if (event.length > 25) {
          tdEvent.innerHTML = `<div class="scroll-container"><div class="marquee">${event}</div></div>`;
        } else {
          tdEvent.textContent = event;
        }

        const tdRoom = document.createElement("td");
        tdRoom.textContent = room;

        tr.appendChild(tdTime);
        tr.appendChild(tdEvent);
        tr.appendChild(tdRoom);
        tbody.appendChild(tr);
      });
    }

    loadCSV();
    setInterval(loadCSV, REFRESH_MS);
  </script>
</body>
</html>
